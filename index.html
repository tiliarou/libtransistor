<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>libtransistor: libtransistor</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">libtransistor
   </div>
   <div id="projectbrief">A userland library for the Nintendo Switch</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li class="current"><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">libtransistor </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a href="https://travis-ci.org/reswitched/libtransistor"></a> <a href="https://discordapp.com/invite/ZdqEhed"></a></p>
<p>Libtransistor is a userland library for the Nintendo Switch. Binaries should run under Mephisto, Yuzu, Ryujinx, and on 3.0.0 consoles via ROhan or nsphax (Homebrew Launcher).</p>
<h2>Documentation</h2>
<p>The documentation is automatically built and can be found here: <a href="https://reswitched.github.io/libtransistor">https://reswitched.github.io/libtransistor</a></p>
<h2>Installation</h2>
<p>For a more in-depth explanation, see <a href="https://reswitchedweekly.github.io/Development-Setup">The Guide</a>.</p>
<p>Download our <a href="https://github.com/reswitched/libtransistor/releases/latest">latest release</a>. Choose either <code>libtransistor_vX.X.X.tar.gz</code> or <code>libtransistor_vX.X.X.zip</code>, and extract it. The recommended place to extract these archives is into <code>/opt/libtransistor/</code>. Next, set the <code>LIBTRANSISTOR_HOME</code> environment variable to wherever you extracted the archive.</p>
<p>The <code>tests_{nro,nso}.{tar.gz,zip}</code> archives contain builds of all of the tests included with libtransistor.</p>
<h2>Usage</h2>
<p>If you're using a Makefile-based build system, include <code>/libtransistor.mk</code>. You will also need to provide custom linking rules. See <a href="https://github.com/reswitched/libtransistor/blob/development/projects/example/Makefile"><code>projects/example/</code></a> for an example of how to do this.</p>
<p>Otherwise, specify <code>CC_FLAGS</code> and <code>LD_FLAGS</code> and such based off of <a href="https://github.com/reswitched/libtransistor-base/blob/master/libtransistor.mk"><code>libtransistor.mk</code></a>.</p>
<h2>Building</h2>
<p>For a more in-depth explanation, see <a href="https://reswitchedweekly.github.io/Development-Setup">The Guide</a>.</p>
<p>First, clone the repo with</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;git clone --recursive https://github.com/reswitched/libtransistor</div></div><!-- fragment --><p>Next, get a copy of <a href="https://github.com/reswitched/libtransistor-base.git">libtransistor-base</a>. You can either <a href="https://github.com/reswitched/libtransistor-base#building">build it yourself</a>, or download a <a href="https://github.com/reswitched/libtransistor-base/releases">pre-built release</a>. Pick a release with a version number equal to the version of libtransistor that you are building, or the next lowest if no such version exists. If you build it yourself, copy the <code>dist/</code> folder from libtransistor-base to the root of this repository's contents, so it's in the same place as this <code>README.md</code> and <code>lib</code> and <code>include</code>. If you download a release, extract it into a new folder called <code>dist</code>.</p>
<p>You will need Python 3 and the python packages listed in <a href="https://github.com/reswitched/libtransistor-base/blob/master/requirements.txt"><code>dist/requirements.txt</code></a>. You'll also need clang and lld &gt;=5.0 (llvm linker).</p>
<p>You <em>should</em> just be able to run <code>make</code>. If that doesn't work, submit an issue (or pull request). This will produce a number of <code>nro</code> and <code>nso</code> files in <code>build/test/</code>. These are binaries for the Nintendo Switch. NRO files are relocatable shared objects suitable for use with <a href="https://reswitched.tech/rohan">ROhan</a>, <a href="https://switchbrew.github.io/nx-hbl/">the Homebrew Launcher</a>, or any other loader taking NROs. Both NRO and NSO binaries can be run under Mephisto.</p>
<h3>Building on Fedora</h3>
<p>Fedora does not ship recent enough clang and lld binaries. However, pre-built clang binaries from <a href="https://releases.llvm.org">llvm.org</a> can be used.</p>
<p>Example:</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;wget -c http://releases.llvm.org/5.0.1/clang+llvm-5.0.1-x86_64-linux-gnu-Fedora27.tar.xz</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;tar xpf clang+llvm-5.0.1-x86_64-linux-gnu-Fedora27.tar.xz</div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;export PATH=`pwd`/clang+llvm-5.0.1-x86_64-linux-gnu-Fedora27/bin:$PATH</div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;cd libtransistor</div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;make</div></div><!-- fragment --><p>If some of the cmake CXX tests fail, you may need to install the necessary dependencies.</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;sudo dnf -y install libstdc++-devel gcc-c++.x86_64</div></div><!-- fragment --><h3>Building on Arch Linux</h3>
<p>You'll need to install some packages. </p><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;sudo pacman -S llvm clang lld python python-pip squashfs-tools base-devel git cmake</div></div><!-- fragment --><p>and you'll also need to install some python dependencies via pip. </p><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;pip install --user -r requirements.txt</div></div><!-- fragment --><h3>Building on OSX</h3>
<p>You will need to install <code>squashfs</code>: </p><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;brew install squashfs</div></div><!-- fragment --><h2>Running</h2>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;$ ./ctu --load-nro &lt;path-to-libtransistor&gt;/build/test/&lt;binary&gt;.nro</div></div><!-- fragment --><p> For running the <code>bsd</code> test, you may want to also pass <code>--enable-sockets</code>. Don't pass that for anything you don't want phoning home, though.</p>
<h2>Debugging</h2>
<p>Because Mephisto comes with a GDB stub and we produce standard ELF files before converting to NSO/NRO, we can debug libtransistor binaries very easily.</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;$ ./ctu --load-nro &lt;path-to-libtransistor&gt;/build/test/&lt;binary&gt;.nro --enable-gdb</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;[GdbStub] INFO: Starting GDB server on port 24689...</div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;[GdbStub] INFO: Waiting for gdb to connect...</div></div><!-- fragment --> <div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;$ aarch64-none-elf-gdb </div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;(gdb) target remote localhost:24689</div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;Remote debugging using localhost:24689</div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;warning: No executable has been specified and target does not support</div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;determining executable automatically.  Try using the &quot;file&quot; command.</div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;0x0000007100000080 in ?? ()</div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;(gdb) add-symbol-file &lt;path-to-libtransistor&gt;/build/test/&lt;binary&gt;.nro.so 0x7100000000 -s .bss 0x7100000000</div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;add symbol table from file &quot;&lt;path-to-libtransistor&gt;/build/test/&lt;binary&gt;.nro.so&quot; at</div><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;    .text_addr = 0x7100000000</div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;    .bss_addr = 0x7100000000</div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;(y or n) y</div><div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;Reading symbols from &lt;path-to-libtransistor&gt;/build/test/&lt;binary&gt;.nro.so...done.</div><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;(gdb) </div></div><!-- fragment --> </div></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Sat Jun 30 2018 01:11:35 for libtransistor by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.11
</small></address>
</body>
</html>
